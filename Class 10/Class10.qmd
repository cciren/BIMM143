---
title: "Class 10: Structural Bioinformatics (pt.1) "
author: "Irene Hsieh (A16197563)"
format: pdf
---

# The PDB Structure

Here we examine the size and composition of the main database of biomolecular structure - the PDB.

Get a CSV file from the PDB database and read it into R

```{r}
pdbstats <- read.csv("pdb_stats.csv", row.names = 1)
head(pdbstats)
```

> Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

My pdbstats data frame has numbers with commas in them. This may cause us 
problems.(strings) Let's see:

```{r}
sum(as.numeric(gsub(",", "", pdbstats$X.ray)))

```

I can turn this snipet into a function that i can use for every column in the 
table.

```{r}
commasum <- function(x){
  sum(as.numeric(gsub(",","", x)))
}

commasum(pdbstats$X.ray)
```

Apply across all columns

```{r}
apply(pdbstats, 2, commasum)
totals <- apply(pdbstats, 2, commasum)
```

```{r}
round(totals/totals["Total"]*100, 2)
```
A. 84.54+8.72 = 93.26

> Q2: What proportion of structures in the PDB are protein?


```{r}
(215684/24975189*100)
```

#2. Visualizing Protein Structure 

We will learn the basics of Mol* (mol-star) homepage: 
https://molstar.org/viewer/

We will play with PDB code 1HSG

![](1HSG.png)

> Show the Asp25 residue 

![HIV-Pr with a bound inhibitor showing the two important Asp 25 residues](1HSGwater.png)

## Back to R and working with PDB structures 

Predict the dynamics (flexibility) of an important protein:

```{r}
library(bio3d)

hiv<- read.pdb("1hsg")
hiv
```

```{r}
head(hiv$atom)
```

```{r}
pdbseq(hiv)
```

Here we will do a Normal Mode Abalysis (NMA) to predict functional motions of a kinase protein

```{r}
adk <- read.pdb("6s36")
adk
```

```{r}
modes <- nma(adk)
plot(modes)
```
Make a "movie" called a trajectory of the predicted motions:

```{r}
mktrj(modes, file="adk_m7.pdb")
```

Then I can open this file in Mol*... 

